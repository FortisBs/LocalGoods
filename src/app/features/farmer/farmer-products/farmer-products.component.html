<div class="products-container">
  <h2>My goods</h2>
  <button class="add-product-btn" (click)="isModalAddOpened = true">Add product</button>

  <div class="products">
    <app-farmer-product *ngFor="let product of products$ | async"
                        [product]="product">
    </app-farmer-product>
  </div>
</div>

<app-modal *ngIf="isModalAddOpened" (isModalOpened)="isModalAddOpened = $event">
  <div class="modal">
    <p class="modal-title">Add product</p>

    <form class="modal-form" #addProductForm="ngForm"
          (ngSubmit)="onAddProduct(addProductForm.value)">

      <div class="form-group">
        <label for="productName">Product name</label>
        <input type="text" id="productName" name="productName" ngModel #productName="ngModel" required minlength="3">
        <div *ngIf="productName.touched" class="form-validator">
          <span *ngIf="productName.errors?.['required']">Product name is Required!</span>
          <span *ngIf="productName.errors?.['minlength']">Product name minimum 3 characters are required!</span>
        </div>
      </div>

      <div class="form-group">
        <label for="productDesc">Product description</label>
        <input type="text" id="productDesc" name="productDesc" ngModel #productDesc="ngModel" required minlength="50">
        <div *ngIf="productDesc.touched" class="form-validator">
          <span *ngIf="productDesc.errors?.['required']">Product description is Required!</span>
          <span *ngIf="productDesc.errors?.['minlength']">Product description minimum 50 characters are required!</span>
        </div>
      </div>

      <div class="form-group">
        <label for="productImg">Product image</label>
        <input type="file" class="file-upload" id="productImg" name="productImg" ngModel #fileUpload="ngModel" (change)="onFileSelected($event)" requiredFileType="image/jpg">
        <div *ngIf="fileUpload.touched" class="form-note-text">
          <span>Selected file: {{ fileName || "No file uploaded yet."}}</span>
        </div>
        <div *ngIf="fileUpload.errors?.['requiredFileType']" class="form-validator">
          <span *ngIf="fileUpload.errors?.['requiredFileType']">Only jpg is acceptable file format</span>
        </div>
      </div>

      <div class="form-group">
        <label for="productPrice">Product price</label>
        <input type="number" id="productPrice" name="productPrice" ngModel #productPrice="ngModel" required min="1">
        <div *ngIf="productPrice.touched" class="form-validator">
          <span *ngIf="productPrice.errors?.['required']">Product price is Required!</span>
          <span *ngIf="productPrice.errors?.['min']">Product price minimum 1 UAH!</span>
        </div>
      </div>

      <div class="form-group">
        <label for="productCategory">Product category</label>
        <select id="productCategory" name="productCategory" ngModel #productCategory="ngModel" required>
          <option *ngFor="let category of categoriesList" [value]="category.id">
            {{ category.name }}
          </option>
        </select>
        <div *ngIf="productCategory.touched" class="form-validator">
          <span *ngIf="productCategory.errors?.['required']">Please select a category!</span>
        </div>
      </div>

      <div class="modal-buttons">
        <button type="submit" [disabled]="!addProductForm.form.valid">Create product</button>
        <button type="button" (click)="isModalAddOpened = false">Cancel</button>
      </div>
    </form>

  </div>
</app-modal>
